<%= render 'layouts/header' %>

<div class="main-wrapper">
  <div class="container">
    <div class="area_box">
      <pre><p>第<%= @post.state.direction_id %>方面 <%= @post.state.name %> ・ <%= @post.area.name %>  被害状況</p></pre>

      <% if @post.images.attached? %>
        <% if @post.images.length < 2 %>
          <% @post.images.each do |image| %>
            <%= image_tag image, class: "post-img" %>
          <% end %>
        <% else %>
          <div class="previews">
            <div class="slider">
              <% @post.images.each do |image| %>
                <div>
                  <%= image_tag image, class: "slick-posts-img" %>
                </div>
              <% end %>
            </div>
          </div>
        <% end %>
      <% end %>

      <% if @post.video.attached? %>
        <td>
          <video src="<%= rails_blob_path(@post.video) %> " type="video/mp4" width="500" height="280" controls></video>
        </td>
      <% end %>
    </div>

    <div class="posts-box_show">
      <h1><span>《被害状況》</span></h1>
      <div>
        <pre>・所在：&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<%= @post.state.name %> <%= @post.area.name %></pre>
      </div>
      <div>
        <pre>・番地/目印：&nbsp;<%= @post.mark %></pre>
      </div>
      <div>
        <pre>・ケガ人の人数：&nbsp;&nbsp;&nbsp;&nbsp;<%= @post.escape.name %></pre>
      </div>
      <div>
        <pre>・逃げ遅れの人数：&nbsp;&nbsp;&nbsp;<%= @post.help.name %></pre>
      </div>
      <div>
        <pre>・消防隊の要請：&nbsp;&nbsp;&nbsp;&nbsp;<%= @post.injury.name %></pre>
      </div>
      <div>
        <pre>・詳細内容：&nbsp;&nbsp;&nbsp;&nbsp;<%= @post.content %></pre>
      </div>
      <div>
        <pre>・対応状況：&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<%= @status_name %></pre>
      </div>

      <div class="status_id">
        <% if @post.status == 3 %>
            <div class="status_nil">未対応</div>
        <% elsif @post.status ==1 %>
            <div  class="status_1">対応中</div>
        <% else %>
          <% if @post.status == 2 %>
            <div  class="status_2">対応済み</div>
          <% end %>
        <% end %>
      </div>
    </div>
  </div>
</div>

<div class=comment-box>
  <div class="comments">
    <p>《コメント一覧》</p>
    <% @comments.each do |comment| %>
      <div class="comment">
        <p><%= comment.comment %></p>
      </div>
    <% end %>
  </div>

  <div class="comment-form">
   <p>コメント入力フォーム</p>
    <% if user_signed_in? %>
      <%= form_with model: [@post, @comment] do |f| %>
        <%= f.text_area :comment, class: "comment-text" %><br>
        <%= f.submit "送信", class: "comment-submit" %>
      <% end %>
    <% end %>
  </div>

  <% if user_signed_in? %>
  <p>ログイン中のユーザー: <%= current_user.user_type %></p>
<% else %>
  <p>ログインしていません</p>
<% end %>


 <div class="status-id">
  <% if current_user.user_type == 1 %>
    <p>《対応状況変更フォーム》</p>
    <%= form_with model: @post do |f| %>
      <%= f.select :status, [["未対応", 3 ],["対応中", 1], ["対応済み", 2]], class: "status-text", include_blank: "対応状況を選択してください" %><br>
      <%= f.submit "送信", class: "comment-submit" %>
    <% end %> 
    </div>
 <%end%>

 <%= link_to root_path do %>
 <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" fill="currentColor" class="left-square" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M15 2a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2zM0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2zm11.5 5.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H11.5z"/>
 </svg>  
 <% end %>